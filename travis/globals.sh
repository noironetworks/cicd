#!/bin/bash
set -x
RELEASE_TAGS=("6.0.3.2")
RELEASE_TAG="undefined"
if [[ ${RELEASE_TAGS[@]} =~ ${TRAVIS_TAG} ]]
then
    RELEASE_TAG=${TRAVIS_TAG}
else
    echo "The applied git tag " ${TRAVIS_TAG} " did not match any of the expected release tags " ${RELEASE_TAGS[@]} ". Skipping building."
    exit 140
fi
export RELEASE_TAG
DATE_TAG=$(date +"%m%d%y")
TRAVIS_TAG_WITH_UPSTREAM_ID=${TRAVIS_TAG}.${UPSTREAM_ID}
TRAVIS_TAG_WITH_UPSTREAM_ID_DATE_TRAVIS_BUILD_NUMBER=${TRAVIS_TAG_WITH_UPSTREAM_ID}.${DATE_TAG}.${TRAVIS_BUILD_NUMBER}
IMAGE_TAG=${TRAVIS_TAG_WITH_UPSTREAM_ID}
UPSTREAM_IMAGE_TAG=${RELEASE_TAG}.${UPSTREAM_ID}
UPSTREAM_IMAGE_Z_TAG=${RELEASE_TAG}.${UPSTREAM_ID}.z
IMAGE_Z_TAG=${TRAVIS_TAG_WITH_UPSTREAM_ID}.z
RELEASE_Z_TAG=${RELEASE_TAG}.z
RC_PREFIX=${RELEASE_TAG}rc
RC_REGEX=${RC_PREFIX}[0-9]+
QUAY_REGISTRY=quay.io/noirolabs
QUAY_NOIRO_REGISTRY=quay.io/noiro
DOCKER_REGISTRY=docker.io/noiro
CICD_STATUS_REPO="https://github.com/noironetworks/cicd-status.git"
